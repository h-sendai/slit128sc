メモ

元データファイルの構造

# (hash, sharp)で始まる行はコメント。

コメント以外の有効行について、最初のものはDIPスイッチの設定を示すもので
base_addrの決定に使われる。DIPスイッチは7個ある。
1がオン、0がオフ。
1111111 == 111 1111 の場合は 0x7f << 24 がベースアドレスになる。

チャンネルデータについて第1カラムがチャンネル番号、第2カラムが設定値。
カラムの区切りはスペースあるいはタブ。
設定値は H, Lが16個並んだもの。
HLLLLLLLLLLLLLLL == HLLL LLLL LLLL LLLL
と区切り
HLLL LLLL LLLL LLLL
--------- ---------
第1バイト 第2バイト
となる。

スローコントロールデータの送信

1. 準備
   base_addr + 0x0b に 0x47 を送る。
   base_addr + 0x0c に 0xff を送る。
   base_addr + 0x0d に 0x55 を送る。
   base_addr + 0x0b を1バイト(繰り返し)読んで、先頭1ビットが0になるのを待つ
   (1ならbusy)

2. チャンネルデータを128チャンネル分順次送る
   1チャンネル分送るには次のようにする
   base_addr + 0x0c に 0x00 を送る。
   base_addr + 0x0d に 第1バイトを送る。
   base_addr + 0x0b を1バイト(繰り返し)読んで、先頭1ビットが0になるのを待つ

   base_addr + 0x0c に 0x00 を送る。
   base_addr + 0x0d に 第2バイトを送る。
   base_addr + 0x0b を1バイト(繰り返し)読んで、先頭1ビットが0になるのを待つ
   
   同様に次のチャンネルを送る。
   128チャンネル分送ったら次の3.を実行する。

3. 最後
   base_addr + 0x0c に 0xff を送る。
   base_addr + 0x0d に 0x55 を送る。
   base_addr + 0x0b を1バイト(繰り返し)読んで、先頭1ビットが0になるのを待つ
   
